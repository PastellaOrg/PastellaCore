<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pastella Monitoring Dashboard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-cube"></i>
                    <h1>Pastella Monitoring</h1>
                </div>
                <div class="header-status">
                    <button class="theme-toggle" id="themeToggle" title="Toggle Dark Mode">
                        <i class="fas fa-moon"></i>
                    </button>
                    <span class="status-indicator" id="connectionStatus">
                        <i class="fas fa-circle"></i>
                        <span>Connected</span>
                    </span>
                    <span class="timestamp" id="lastUpdate">Loading...</span>
                </div>
            </div>
        </header>

        <!-- Navigation Menu -->
        <nav class="dashboard-nav">
            <div class="nav-sections">
                <div class="nav-section">
                    <h4><i class="fas fa-tachometer-alt"></i> Dashboard</h4>
                    <ul>
                        <li><a href="#overview" class="nav-link active" data-section="overview"><i class="fas fa-chart-line"></i> Overview</a></li>
                        <li><a href="#analytics" class="nav-link" data-section="analytics"><i class="fas fa-chart-area"></i> Live Analytics</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4><i class="fas fa-cubes"></i> Blockchain</h4>
                    <ul>
                        <li><a href="#blocks" class="nav-link" data-section="blocks"><i class="fas fa-cube"></i> Block Explorer</a></li>
                        <li><a href="#transactions" class="nav-link" data-section="transactions"><i class="fas fa-exchange-alt"></i> Transactions</a></li>
                        <li><a href="#mempool" class="nav-link" data-section="mempool"><i class="fas fa-hourglass-half"></i> Memory Pool</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4><i class="fas fa-network-wired"></i> Network</h4>
                    <ul>
                        <li><a href="#peers" class="nav-link" data-section="peers"><i class="fas fa-users"></i> Peer Management</a></li>
                        <li><a href="#network-analysis" class="nav-link" data-section="network-analysis"><i class="fas fa-project-diagram"></i> Network Analysis</a></li>
                        <li><a href="#bandwidth" class="nav-link" data-section="bandwidth"><i class="fas fa-wifi"></i> Bandwidth Monitor</a></li>
                        <li><a href="#topology" class="nav-link" data-section="topology"><i class="fas fa-sitemap"></i> Network Topology</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4><i class="fas fa-shield-alt"></i> Security</h4>
                    <ul>
                        <li><a href="#security-monitor" class="nav-link" data-section="security-monitor"><i class="fas fa-eye"></i> Security Monitor</a></li>
                        <li><a href="#attack-detection" class="nav-link" data-section="attack-detection"><i class="fas fa-exclamation-triangle"></i> Attack Detection</a></li>
                        <li><a href="#consensus-monitor" class="nav-link" data-section="consensus-monitor"><i class="fas fa-balance-scale"></i> Consensus Monitor</a></li>
                        <li><a href="#node-blocking" class="nav-link" data-section="node-blocking"><i class="fas fa-ban"></i> Node Blocking</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4><i class="fas fa-cogs"></i> Control</h4>
                    <ul>
                        <li><a href="#node-control" class="nav-link" data-section="node-control"><i class="fas fa-power-off"></i> Node Control</a></li>
                        <li><a href="#logs" class="nav-link" data-section="logs"><i class="fas fa-file-alt"></i> Activity Logs</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Main Dashboard -->
        <main class="dashboard-main">
            <!-- Overview Section -->
            <div id="overview-section" class="dashboard-section active">
                <!-- Overview Cards -->
            <section class="overview-cards">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-server"></i>
                        <h3>Node Status</h3>
                    </div>
                    <div class="card-content">
                        <div class="stat">
                            <span class="label">Status:</span>
                            <span class="value" id="nodeStatus">Running</span>
                        </div>
                        <div class="stat">
                            <span class="label">Uptime:</span>
                            <span class="value" id="nodeUptime">0s</span>
                        </div>
                        <div class="stat">
                            <span class="label">Version:</span>
                            <span class="value" id="nodeVersion">v1.0.0</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-link"></i>
                        <h3>Blockchain</h3>
                    </div>
                    <div class="card-content">
                        <div class="stat">
                            <span class="label">Height:</span>
                            <span class="value" id="blockHeight">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Difficulty:</span>
                            <span class="value" id="difficulty">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Hash Rate:</span>
                            <span class="value" id="hashRate">0 H/s</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-network-wired"></i>
                        <h3>Network</h3>
                    </div>
                    <div class="card-content">
                        <div class="stat">
                            <span class="label">Peers:</span>
                            <span class="value" id="peerCount">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Connections:</span>
                            <span class="value" id="connectionCount">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Network ID:</span>
                            <span class="value" id="networkId">pastella-14082025</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-microchip"></i>
                        <h3>System</h3>
                    </div>
                    <div class="card-content">
                        <div class="stat">
                            <span class="label">CPU Usage:</span>
                            <span class="value" id="cpuUsage">0%</span>
                        </div>
                        <div class="stat">
                            <span class="label">Memory:</span>
                            <span class="value" id="memoryUsage">0 MB</span>
                        </div>
                        <div class="stat">
                            <span class="label">Disk:</span>
                            <span class="value" id="diskUsage">0 MB</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Detailed Information Tabs -->
            <section class="dashboard-tabs">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="blocks">
                        <i class="fas fa-cubes"></i> Recent Blocks
                    </button>
                    <button class="tab-btn" data-tab="peers">
                        <i class="fas fa-users"></i> Connected Peers
                    </button>
                    <button class="tab-btn" data-tab="system">
                        <i class="fas fa-chart-area"></i> System Info
                    </button>
                    <button class="tab-btn" data-tab="logs">
                        <i class="fas fa-file-alt"></i> Activity Log
                    </button>
                </div>

                <div class="tab-content">
                    <!-- Recent Blocks Tab -->
                    <div class="tab-pane active" id="blocks-tab">
                        <div class="table-container">
                            <h4><i class="fas fa-cubes"></i> Recent Blocks</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Height</th>
                                        <th>Hash</th>
                                        <th>Timestamp</th>
                                        <th>Transactions</th>
                                        <th>Size</th>
                                    </tr>
                                </thead>
                                <tbody id="blocksTableBody">
                                    <tr>
                                        <td colspan="5" class="loading">Loading blocks...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Connected Peers Tab -->
                    <div class="tab-pane" id="peers-tab">
                        <div class="table-container">
                            <h4><i class="fas fa-users"></i> Connected Peers</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Address</th>
                                        <th>Status</th>
                                        <th>Uptime</th>
                                        <th>Reputation</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody id="peersTableBody">
                                    <tr>
                                        <td colspan="5" class="loading">Loading peers...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- System Info Tab -->
                    <div class="tab-pane" id="system-tab">
                        <div class="system-info">
                            <h4><i class="fas fa-info-circle"></i> System Information</h4>
                            <div class="info-grid">
                                <div class="info-section">
                                    <h5>Node Details</h5>
                                    <div class="info-item">
                                        <span class="label">Process ID:</span>
                                        <span class="value" id="processId">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">Platform:</span>
                                        <span class="value" id="platform">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">Architecture:</span>
                                        <span class="value" id="architecture">-</span>
                                    </div>
                                </div>
                                <div class="info-section">
                                    <h5>Hardware</h5>
                                    <div class="info-item">
                                        <span class="label">CPU Cores:</span>
                                        <span class="value" id="cpuCores">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">Total Memory:</span>
                                        <span class="value" id="totalMemory">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">Free Memory:</span>
                                        <span class="value" id="freeMemory">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Log Tab -->
                    <div class="tab-pane" id="logs-tab">
                        <div class="logs-container">
                            <h4><i class="fas fa-file-alt"></i> Activity Log</h4>
                            <div class="log-controls">
                                <button class="btn btn-small" id="clearLogs">
                                    <i class="fas fa-trash"></i> Clear
                                </button>
                                <button class="btn btn-small" id="pauseLogs">
                                    <i class="fas fa-pause"></i> Pause
                                </button>
                            </div>
                            <div class="log-output" id="logOutput">
                                <div class="log-entry">
                                    <span class="log-time">Loading...</span>
                                    <span class="log-message">Initializing activity log...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            </div>

            <!-- Live Analytics Section -->
            <div id="analytics-section" class="dashboard-section">
                <h2><i class="fas fa-chart-area"></i> Live Analytics & Charts</h2>
                <div class="analytics-grid">
                    <div class="chart-container">
                        <h3>Live Block Time Chart</h3>
                        <canvas id="blockTimeChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Network Hash Rate History</h3>
                        <canvas id="hashRateChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Transaction Volume Graph</h3>
                        <canvas id="transactionVolumeChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Memory Pool Size Chart</h3>
                        <canvas id="mempoolChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Difficulty Adjustment Graph</h3>
                        <canvas id="difficultyChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Network Latency Heatmap</h3>
                        <canvas id="latencyChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Transaction Fee Analysis</h3>
                        <canvas id="feeAnalysisChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Peer Connection Map</h3>
                        <div id="peerMap" style="height: 400px;"></div>
                    </div>
                </div>
            </div>

            <!-- Block Explorer Section -->
            <div id="blocks-section" class="dashboard-section">
                <h2><i class="fas fa-cube"></i> Advanced Block Explorer</h2>
                <div class="explorer-tools">
                    <div class="search-bar">
                        <input type="text" id="blockSearch" placeholder="Search by block hash, height, or transaction...">
                        <button class="btn" onclick="searchBlocks()"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                <div class="blocks-grid">
                    <div class="block-list">
                        <h3>Recent Blocks</h3>
                        <div id="detailedBlocksList"></div>
                    </div>
                    <div class="block-details" id="blockDetailsPanel">
                        <h3>Block Details</h3>
                        <div id="selectedBlockDetails">Select a block to view details</div>
                    </div>
                </div>
            </div>

            <!-- Transactions Section -->
            <div id="transactions-section" class="dashboard-section">
                <h2><i class="fas fa-exchange-alt"></i> Transaction History</h2>

                <!-- Search and Filter Controls -->
                <div class="transactions-controls">
                    <div class="search-filter-row">
                        <div class="search-bar">
                            <input type="text" id="transactionSearch" placeholder="Search by hash, address, or amount...">
                            <button class="btn" onclick="searchTransactions()">
                                <i class="fas fa-search"></i> Search
                            </button>
                        </div>
                        <div class="filter-controls">
                            <select id="transactionTypeFilter">
                                <option value="">All Types</option>
                                <option value="TRANSACTION">Regular</option>
                                <option value="COINBASE">Coinbase</option>
                                <option value="PREMINE">Premine</option>
                                <option value="STAKING">Staking</option>
                                <option value="GOVERNANCE">Governance</option>
                            </select>
                            <input type="date" id="fromDate" title="From Date">
                            <input type="date" id="toDate" title="To Date">
                            <select id="amountFilter">
                                <option value="">Any Amount</option>
                                <option value="0-1">0-1 PAST</option>
                                <option value="1-10">1-10 PAST</option>
                                <option value="10-100">10-100 PAST</option>
                                <option value="100+">100+ PAST</option>
                            </select>
                            <button class="btn btn-small" onclick="clearTransactionFilters()">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                    </div>

                    <!-- Transaction Stats -->
                    <div class="transaction-stats">
                        <div class="stat-card">
                            <span class="stat-label">Total Transactions</span>
                            <span class="stat-value" id="totalTransactions">-</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-label">24h Volume</span>
                            <span class="stat-value" id="dailyVolume">- PAST</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-label">Average Fee</span>
                            <span class="stat-value" id="averageFee">- PAST</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-label">Pending</span>
                            <span class="stat-value" id="pendingCount">-</span>
                        </div>
                    </div>
                </div>

                <!-- Transaction Table -->
                <div class="transactions-container">
                    <div class="transactions-table-wrapper">
                        <table class="transactions-table">
                            <thead>
                                <tr>
                                    <th>Hash</th>
                                    <th>Type</th>
                                    <th>From</th>
                                    <th>To</th>
                                    <th>Amount</th>
                                    <th>Fee</th>
                                    <th>Status</th>
                                    <th>Time</th>
                                    <th>Block</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTableBody">
                                <tr class="loading-row">
                                    <td colspan="10">
                                        <div class="loading-indicator">
                                            <i class="fas fa-spinner fa-spin"></i>
                                            Loading transactions...
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div class="pagination-controls">
                        <div class="pagination-info">
                            <span>Showing <span id="transactionStart">0</span> to <span id="transactionEnd">0</span> of <span id="transactionTotal">0</span> transactions</span>
                        </div>
                        <div class="pagination-buttons">
                            <button class="btn btn-small" id="prevPage" onclick="previousTransactionPage()">
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <span class="page-info">Page <span id="currentPage">1</span> of <span id="totalPages">1</span></span>
                            <button class="btn btn-small" id="nextPage" onclick="nextTransactionPage()">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Transaction Details Modal -->
                <div class="modal" id="transactionModal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Transaction Details</h3>
                            <button class="modal-close" onclick="closeTransactionModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body" id="transactionModalBody">
                            <!-- Transaction details will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Memory Pool Section -->
            <div id="mempool-section" class="dashboard-section">
                <h2><i class="fas fa-hourglass-half"></i> Memory Pool Monitor</h2>

                <!-- Memory Pool Statistics -->
                <div class="mempool-stats">
                    <div class="stat-card">
                        <span class="stat-label">Pending Transactions</span>
                        <span class="stat-value" id="mempoolTxCount">-</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Total Value</span>
                        <span class="stat-value" id="mempoolTotalValue">- PAST</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Total Fees</span>
                        <span class="stat-value" id="mempoolTotalFees">- PAST</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Memory Usage</span>
                        <span class="stat-value" id="mempoolMemoryUsage">- KB</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Queue Time</span>
                        <span class="stat-value" id="mempoolQueueTime">- min</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-label">Status</span>
                        <span class="stat-value" id="mempoolStatus">-</span>
                    </div>
                </div>

                <!-- Memory Pool Analysis -->
                <div class="mempool-analysis">
                    <div class="analysis-panel">
                        <h3><i class="fas fa-chart-bar"></i> Transaction Analysis</h3>
                        <div class="analysis-content">
                            <div class="fee-analysis">
                                <h4>Fee Distribution</h4>
                                <div class="fee-chart-container">
                                    <canvas id="mempoolFeeChart"></canvas>
                                </div>
                                <div class="fee-recommendations" id="feeRecommendations">
                                    <div class="fee-tier">
                                        <span class="tier-label">Low Priority:</span>
                                        <span class="tier-fee" id="lowFee">- PAST</span>
                                    </div>
                                    <div class="fee-tier">
                                        <span class="tier-label">Medium Priority:</span>
                                        <span class="tier-fee" id="mediumFee">- PAST</span>
                                    </div>
                                    <div class="fee-tier">
                                        <span class="tier-label">High Priority:</span>
                                        <span class="tier-fee" id="highFee">- PAST</span>
                                    </div>
                                </div>
                            </div>
                            <div class="type-distribution">
                                <h4>Transaction Types</h4>
                                <div class="type-chart-container">
                                    <canvas id="mempoolTypeChart"></canvas>
                                </div>
                                <div class="type-breakdown" id="typeBreakdown">
                                    <!-- Will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="analysis-panel">
                        <h3><i class="fas fa-clock"></i> Queue Analysis</h3>
                        <div class="analysis-content">
                            <div class="queue-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Oldest Transaction:</span>
                                    <span class="metric-value" id="oldestTxAge">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Average Wait Time:</span>
                                    <span class="metric-value" id="avgWaitTime">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Processing Rate:</span>
                                    <span class="metric-value" id="processingRate">- tx/min</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Estimated Clear Time:</span>
                                    <span class="metric-value" id="estimatedClearTime">-</span>
                                </div>
                            </div>
                            <div class="congestion-meter">
                                <h4>Network Congestion</h4>
                                <div class="congestion-bar">
                                    <div class="congestion-fill" id="congestionFill"></div>
                                </div>
                                <div class="congestion-labels">
                                    <span>Low</span>
                                    <span>Medium</span>
                                    <span>High</span>
                                </div>
                                <div class="congestion-status" id="congestionStatus">Normal</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pending Transactions List -->
                <div class="mempool-transactions">
                    <div class="transactions-header">
                        <h3><i class="fas fa-list"></i> Pending Transactions</h3>
                        <div class="transactions-controls">
                            <select id="mempoolSortBy">
                                <option value="fee">Sort by Fee (High to Low)</option>
                                <option value="time">Sort by Time (Newest First)</option>
                                <option value="size">Sort by Size</option>
                                <option value="type">Sort by Type</option>
                            </select>
                            <select id="mempoolFilterType">
                                <option value="">All Types</option>
                                <option value="TRANSACTION">Regular</option>
                                <option value="COINBASE">Coinbase</option>
                                <option value="PREMINE">Premine</option>
                                <option value="STAKING">Staking</option>
                                <option value="GOVERNANCE">Governance</option>
                            </select>
                            <button class="btn btn-small" onclick="refreshMempool()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>

                    <div class="mempool-table-container">
                        <table class="mempool-table">
                            <thead>
                                <tr>
                                    <th>Hash</th>
                                    <th>Type</th>
                                    <th>From</th>
                                    <th>To</th>
                                    <th>Amount</th>
                                    <th>Fee</th>
                                    <th>Fee Rate</th>
                                    <th>Size</th>
                                    <th>Age</th>
                                    <th>Priority</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="mempoolTableBody">
                                <tr class="loading-row">
                                    <td colspan="11">
                                        <div class="loading-indicator">
                                            <i class="fas fa-spinner fa-spin"></i>
                                            Loading pending transactions...
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="mempool-pagination">
                        <div class="pagination-info">
                            <span>Showing <span id="mempoolStart">0</span> to <span id="mempoolEnd">0</span> of <span id="mempoolTotal">0</span> transactions</span>
                        </div>
                        <div class="pagination-buttons">
                            <button class="btn btn-small" id="mempoolPrevPage" onclick="previousMempoolPage()">
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <span class="page-info">Page <span id="mempoolCurrentPage">1</span> of <span id="mempoolTotalPages">1</span></span>
                            <button class="btn btn-small" id="mempoolNextPage" onclick="nextMempoolPage()">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Memory Pool Alerts -->
                <div class="mempool-alerts" id="mempoolAlerts">
                    <!-- Alerts will be populated by JavaScript -->
                </div>
            </div>

            <!-- Network Analysis Section -->
            <div id="network-analysis-section" class="dashboard-section">
                <h2><i class="fas fa-project-diagram"></i> Network Analysis</h2>
                <div class="network-grid">
                    <div class="panel">
                        <h3><i class="fas fa-star"></i> Peer Reputation System</h3>
                        <div id="peerReputationList"></div>
                    </div>
                    <div class="panel">
                        <h3><i class="fas fa-sitemap"></i> Network Topology</h3>
                        <div id="networkTopology"></div>
                    </div>
                    <div class="panel">
                        <h3><i class="fas fa-globe"></i> Geographic Distribution</h3>
                        <div id="geographicDistribution"></div>
                    </div>
                    <div class="panel">
                        <h3><i class="fas fa-code-branch"></i> Peer Versions</h3>
                        <div id="peerVersions"></div>
                    </div>
                </div>
            </div>

            <!-- Bandwidth Monitor Section -->
            <div id="bandwidth-section" class="dashboard-section">
                <h2><i class="fas fa-wifi"></i> Bandwidth Monitor</h2>
                <div class="bandwidth-grid">
                    <div class="bandwidth-chart">
                        <canvas id="bandwidthChart"></canvas>
                    </div>
                    <div class="bandwidth-stats">
                        <div class="stat-card">
                            <h4>Inbound Traffic</h4>
                            <span id="inboundTraffic">0 B/s</span>
                        </div>
                        <div class="stat-card">
                            <h4>Outbound Traffic</h4>
                            <span id="outboundTraffic">0 B/s</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Monitor Section -->
            <div id="security-monitor-section" class="dashboard-section">
                <h2><i class="fas fa-shield-alt"></i> Advanced Security Monitor</h2>

                <!-- Security Overview -->
                <div class="security-overview">
                    <div id="securityOverview">
                        <!-- Dynamic security overview will be populated here -->
                    </div>
                </div>

                <div class="security-tabs">
                    <div class="tabs-row">
                        <div class="tab active" data-tab="alerts">
                            <i class="fas fa-exclamation-triangle"></i> Security Alerts
                        </div>
                        <div class="tab" data-tab="threats">
                            <i class="fas fa-radar"></i> Threat Analysis
                        </div>
                        <div class="tab" data-tab="metrics">
                            <i class="fas fa-chart-line"></i> Security Metrics
                        </div>
                    </div>
                </div>

                <div class="security-content">
                    <!-- Security Alerts Tab -->
                    <div id="alerts-tab" class="security-tab-content active">
                        <div class="security-alerts">
                            <h3><i class="fas fa-bell"></i> Real-time Security Alerts</h3>
                            <div id="securityAlertsList">
                                <div class="loading-spinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    Loading security alerts...
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Threat Analysis Tab -->
                    <div id="threats-tab" class="security-tab-content">
                        <div class="threat-detection">
                            <h3><i class="fas fa-search"></i> Threat Detection & Analysis</h3>
                            <div id="threatDetectionStatus">
                                <div class="loading-spinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    Analyzing threats...
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Metrics Tab -->
                    <div id="metrics-tab" class="security-tab-content">
                        <div class="security-metrics">
                            <h3><i class="fas fa-tachometer-alt"></i> Security Performance Metrics</h3>
                            <div id="securityMetrics">
                                <div class="loading-spinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    Loading security metrics...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attack Detection Section -->
            <div id="attack-detection-section" class="dashboard-section">
                <h2><i class="fas fa-exclamation-triangle"></i> Attack Detection</h2>
                <div class="attack-grid">
                    <div class="attack-monitor">
                        <h3>51% Attack Monitor</h3>
                        <div id="attackMonitor"></div>
                    </div>
                    <div class="anomaly-detection">
                        <h3>Network Anomalies</h3>
                        <div id="anomaliesList"></div>
                    </div>
                </div>
            </div>

            <!-- Node Blocking Section -->
            <div id="node-blocking-section" class="dashboard-section">
                <h2><i class="fas fa-ban"></i> Node Connection Management</h2>
                <div class="blocking-grid">
                    <div class="blocking-controls">
                        <h3>Block Node</h3>
                        <div class="block-form">
                            <input type="text" id="blockNodeInput" placeholder="Enter IP address or node ID">
                            <button class="btn btn-danger" onclick="blockNode()"><i class="fas fa-ban"></i> Block</button>
                        </div>
                    </div>
                    <div class="blocked-list">
                        <h3>Blocked Nodes</h3>
                        <div id="blockedNodesList"></div>
                    </div>
                </div>
            </div>

            <!-- Node Control Section -->
            <div id="node-control-section" class="dashboard-section">
                <h2><i class="fas fa-power-off"></i> Node Control</h2>
                <div class="control-grid">
                    <div class="control-panel">
                        <h3>Node Operations</h3>
                        <div class="control-buttons">
                            <button class="btn btn-warning" onclick="restartNode()">
                                <i class="fas fa-redo"></i> Restart Node
                            </button>
                            <button class="btn btn-danger" onclick="shutdownNode()">
                                <i class="fas fa-power-off"></i> Shutdown Node
                            </button>
                        </div>
                    </div>
                    <div class="node-status-panel">
                        <h3>Node Status</h3>
                        <div id="detailedNodeStatus"></div>
                    </div>
                </div>
            </div>

            <!-- Activity Logs Section -->
            <div id="logs-section" class="dashboard-section">
                <h2><i class="fas fa-file-alt"></i> Activity Logs</h2>
                <div class="logs-container">
                    <div class="log-controls">
                        <button class="btn btn-small" id="clearLogs">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                        <button class="btn btn-small" id="pauseLogs">
                            <i class="fas fa-pause"></i> Pause
                        </button>
                        <select id="logLevel" class="log-filter">
                            <option value="all">All Levels</option>
                            <option value="error">Errors</option>
                            <option value="warning">Warnings</option>
                            <option value="info">Info</option>
                            <option value="success">Success</option>
                        </select>
                    </div>
                    <div class="log-output" id="logOutput">
                        <div class="log-entry">
                            <span class="log-time">Loading...</span>
                            <span class="log-message">Initializing activity log...</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Connecting to Pastella daemon...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="/js/dashboard.js"></script>
</body>
</html>